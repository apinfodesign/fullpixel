var pullPix=angular.module("pullPix",["ngRoute"]);angular.module("pullPix").controller("ApplicationCtrl",["$scope",function(t){t.$on("login",function(n,e){t.currentUser=e})}]),angular.module("pullPix").controller("ListCtrl",["$scope","ListSvc",function(t,n){t.ListAdd=function(){t.listBody&&n.create({body:t.listBody}).success(function(n){t.posts.unshift(n),t.listBody=null})},n.fetch().success(function(n){t.posts=n})}]),angular.module("pullPix").service("ListSvc",["$http",function(t){this.fetch=function(){return t.get("http://localhost:3000/api/posts")},this.create=function(n){return t.post("http://localhost:3000/api/posts",n)}}]),angular.module("pullPix").controller("LoginCtrl",["$scope","UserSvc",function(t,n){t.login=function(e,o){n.login(e,o).then(function(n){t.$emit("login",n.data)})}}]),angular.module("pullPix").controller("RegisterCtrl",["$scope","UserSvc","$location",function(t,n,e){t.register=function(o,l){n.register(o,l).then(function(n){t.$emit("login",n),e.path("/")})}}]),angular.module("pullPix").config(["$routeProvider",function(t){t.when("/",{controller:"ListCtrl",templateUrl:"/templates/posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"})}]),angular.module("pullPix").service("UserSvc",["$http",function(t){var n=this;n.getUser=function(){return t.get("/users").then(function(t){return t.data})},n.login=function(e,o){return t.post("/sessions",{username:e,password:o}).then(function(e){return n.token=e.data,t.defaults.headers.common["X-Auth"]=e.data,n.getUser()})},n.register=function(e,o){return t.post("/users",{username:e,password:o}).then(function(){return n.login(e,o)})}}]);